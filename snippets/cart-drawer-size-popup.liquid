<!-- Hidden input to store the selected variant ID -->
<input type="hidden" id="selected-variant-id" name="id" value="{{ product.variants.first.id }}">

<!-- Size Selector -->
<fieldset class="variant-input-wrap no-auto-select" name="Size" data-index="option1">
    <legend>Size</legend>
    {% for variant in product.variants %}
      <div class="variant-input" data-value="{{ variant.option1 }}" data-option-type="variant-selector">
        <input type="radio"
          form="{{ form_id }}"
          value="{{ variant.option1 }}"
          name="Size"
          data-variant-input
          data-option-name="Size"
          data-option-value="{{ variant.option1 }}"
          data-variant-id="{{ variant.id }}"
          {% if variant == product.selected_or_first_available_variant %} checked {% endif %}
          {% unless variant.available %} disabled{% endunless %}
          id="ProductSelect-{{ variant.id }}">
        <label for="ProductSelect-{{ variant.id }}"
          class="variant__button-label {% unless variant.available %}disabled{% endunless %}">
          {{ variant.option1 }}
        </label>
      </div>
    {% endfor %}
</fieldset>

<!-- Sleeve Selector -->
<fieldset class="variant-input-wrap no-auto-select" name="Sleeve" data-index="option2">
    <legend>Sleeve</legend>
    {% for option in product.options_by_name["Sleeve"] %}
      <div class="variant-input" data-value="{{ option }}" data-option-type="variant-selector">
        <input type="radio"
          form="{{ form_id }}"
          value="{{ option }}"
          name="Sleeve"
          data-option-name="Sleeve"
          data-option-value="{{ option }}"
          id="ProductSelect-Sleeve-{{ option | handleize }}">
        <label for="ProductSelect-Sleeve-{{ option | handleize }}"
          class="variant__button-label">
          {{ option }}
        </label>
      </div>
    {% endfor %}
</fieldset>

<!-- Add to Cart Button -->
<button type="submit" class="btn add-to-cart-btn" id="add-to-cart-btn">Add to Cart</button>

<script>
  let productVariants = {{ product.variants | json }};
  console.log("üîç Product Variants:", productVariants);

  document.querySelectorAll('[data-variant-input]').forEach(input => {
      input.addEventListener('change', function () {
          let selectedSize = document.querySelector('input[name="Size"]:checked')?.value;
          let selectedSleeve = document.querySelector('input[name="Sleeve"]:checked')?.value;
          
          let matchingVariant = productVariants.find(v => 
              v.option1 === selectedSize && v.option2 === selectedSleeve
          );

          if (matchingVariant) {
              console.log("‚úÖ Selected Variant ID:", matchingVariant.id);
              document.querySelector('#selected-variant-id').value = matchingVariant.id;
              document.getElementById("add-to-cart-btn").disabled = false;
          } else {
              console.warn("‚ö†Ô∏è No matching variant found!");
              document.getElementById("add-to-cart-btn").disabled = true;
          }
      });
  });
</script>
